import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

data = {
    "caption_length": [120,90,150,60,200,45,175,80,220,95,160,50,135,110,185,75,205,130,155,40,210,85,145,100,60,230,180,55,90,170,200,45,140,115,95,175,65,155,40,190,130,75,210,150,55,160,100,220,80],
    "posting_hour": [14,18,11,20,9,16,13,21,10,17,15,19,12,8,14,22,11,13,16,18,9,20,10,15,19,12,14,21,17,13,11,20,16,12,18,10,22,15,17,9,14,20,12,13,18,16,19,11,21],
    "hashtag_count": [5,3,8,2,10,1,7,4,12,3,6,0,5,4,9,2,11,4,6,1,10,3,7,4,2,13,8,1,2,6,9,0,5,4,3,7,2,6,1,9,5,2,10,6,1,7,3,12,2],
    "image_quality_score": [8.2,7.5,9.0,6.8,9.5,5.5,8.7,6.1,9.8,7.2,8.4,5.0,8.0,7.0,9.3,6.0,9.7,7.8,8.5,5.2,9.6,6.5,8.9,7.3,6.0,9.9,9.1,5.7,6.8,8.6,9.4,5.3,8.1,7.6,6.9,8.8,5.8,8.3,5.1,9.2,7.9,6.4,9.7,8.5,5.4,8.7,6.7,9.9,6.2],
    "reach": [5400,4300,7200,2800,9100,1900,6400,3100,11200,3500,5800,1500,5000,3900,8500,2600,10000,4700,6200,1700,9500,3000,6900,4200,2400,12000,7600,2100,3300,6100,8800,1600,5200,4400,3600,7000,2500,6000,1800,8200,4900,2900,9700,6300,2000,6500,3400,11000,2700],
    "likes": [320,280,510,150,750,90,420,180,890,200,360,60,330,250,680,140,810,300,400,80,770,170,480,260,130,940,560,110,190,390,690,70,340,280,210,500,135,380,85,610,310,160,780,420,120,430,200,900,150],
    "comments": [45,32,60,20,85,12,55,25,105,30,48,10,40,28,80,18,100,35,50,11,90,22,58,29,16,120,65,14,24,47,78,9,42,30,26,60,17,46,12,72,37,20,92,52,15,55,25,110,18],
    "engagement": [365,312,570,170,835,102,475,205,995,230,408,70,370,278,760,158,910,335,450,91,860,192,538,289,146,1060,625,124,214,437,768,79,382,310,236,560,152,426,97,682,347,180,872,472,135,485,225,1010,168]
}

df = pd.read_csv("social_media_engagement_dataset.csv")

X = df[["caption_length", "posting_hour", "hashtag_count", "image_quality_score", "reach", "likes", "comments"]]
y = df["engagement"]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

model = LinearRegression()
model.fit(X_train, y_train)

y_pred = model.predict(X_test)
mse = np.sqrt(mean_squared_error(y_test, y_pred))

print("Preview")
print(df.head())

print("Model Perfromance:")
print("Mean Squared Error (MSE):", mse)